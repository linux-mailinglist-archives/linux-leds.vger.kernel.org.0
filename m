Return-Path: <linux-leds-owner@vger.kernel.org>
X-Original-To: lists+linux-leds@lfdr.de
Delivered-To: lists+linux-leds@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 94EC12710AB
	for <lists+linux-leds@lfdr.de>; Sat, 19 Sep 2020 23:40:56 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726598AbgISVkz (ORCPT <rfc822;lists+linux-leds@lfdr.de>);
        Sat, 19 Sep 2020 17:40:55 -0400
Received: from mout.kundenserver.de ([217.72.192.73]:38101 "EHLO
        mout.kundenserver.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1726582AbgISVkz (ORCPT
        <rfc822;linux-leds@vger.kernel.org>); Sat, 19 Sep 2020 17:40:55 -0400
X-Greylist: delayed 1171 seconds by postgrey-1.27 at vger.kernel.org; Sat, 19 Sep 2020 17:40:54 EDT
Received: from desktop ([188.192.134.246]) by mrelayeu.kundenserver.de
 (mreue107 [212.227.15.183]) with ESMTPSA (Nemesis) id
 1Mhl4Q-1kxT4U1tmS-00dmHs; Sat, 19 Sep 2020 23:40:50 +0200
From:   "Adrian Schmutzler" <mail@adrianschmutzler.de>
To:     "'Marek Behun'" <marek.behun@nic.cz>
Cc:     <linux-leds@vger.kernel.org>
References: <20200919192427.57033-1-freifunk@adrianschmutzler.de> <20200919223134.2371459c@nic.cz>
In-Reply-To: <20200919223134.2371459c@nic.cz>
Subject: RE: [PATCH v2 1/2] dt-bindings: leds: add LED_FUNCTION for wlan2g/wlan5g
Date:   Sat, 19 Sep 2020 23:40:50 +0200
Message-ID: <00b201d68ecd$8af46280$a0dd2780$@adrianschmutzler.de>
X-Mailer: Microsoft Outlook 15.0
MIME-Version: 1.0
Thread-Index: AQGSFnMYjThUUuTHNtoSB0At7TLDoAHNC5PSqesCwrA=
Content-Language: de
Content-Type: multipart/signed;
        protocol="application/pgp-signature";
        micalg=pgp-sha256;
        boundary="=-=h6ZpeGmqlP0H2h=-="
X-Provags-ID: V03:K1:ERB2tdlfZGa1X+M0uui9l55z33KaesYSViHnmeXKbHbEtlzdo3j
 ESfnLuXsp8BknJ8GtGdrfQCAERgjhBMvtkl6lfvQT6mLG147wIr/whwas7e0aLPTJu/aIXy
 7FV43X/DqmRVBwMMFVef2qbgeztgPCbZQej0welcuyWFoNkLE3GCVv1EnytMm/wiv49l08H
 RKCtJ+aMzf9go3iaN5h5g==
X-Spam-Flag: NO
X-UI-Out-Filterresults: notjunk:1;V03:K0:nGXgz+zY2is=:yn2VzjY9PrmZKwfxQPb0G2
 LH+ft+CwOH2VFiRjhNitsh8JAytQJkHogaY4iE8X4GNbzyx8Xun+rdnJNvc1chhqk6yLNl0K+
 6pBhnd4jY6yFfhW67gVDrs8pRusaduoxEnH2c+QiVj8iCIllvq4Mbtl0QqwihjZz+xlqaGKvb
 /f7XqHbsW4NqTjVI9lPuaA2GGbsnmS4mTyJgZx3j2Sqw5tb4g7Dqs99jen7DFTYOCeQ4gfc+0
 /DXlZDy3WuRaXfxbxXFkcK0EDVWJvsfBvaIjo1tha1meExZD/gfHaYbVHHSXa58eJCjeRyDlb
 4Dgy4cZCPMB7PohQAoTI7bioOdbSfkMF9vVWj9XsuwX+6KdxLmzFjQT+X8sMBEymVHin4XQzZ
 1Zlds8FMd9kPmQCE0N2LZaRFww95RrhP7VkdTW7KwzjyiY4s0M3Cs9lgHjFF7x0l3RU3bCSSV
 wu41DMOzINo+kw2sMmNkMCcAeyR1mP2tYUGA9TB4SjVNSD4ZGUkPBKIjgp37O3iTocjDRMKM7
 Av1R4fdgtJKZDQu0ELhkydcM36C6ii5RY+CsZo/DLdva6lq0oW/wZvuqj7uTIFwqCVaA8YB1M
 UHFnvyl2HlcV53HOuv6XwHEq5gD7qAuS8dMVSAmBoAWaGj9BoLf+qUEbFTcAt634gjBkYBOYv
 q+/GZGM8E48FaG7kgxxAWnv8NBBkEI0Baw7GIwPIL4rkgdwNaMmh46awaKa/VHBbWkXHbtJ89
 bdZeuoMXvuky3OYSCeXJuMmbbI0wmHfG280OWHPHBBnKFWm7TPimCTKhoiCfunx6UsAr0A4Pk
 Y14Kha+XKn1ho19XVvKEeQx978D07MjapB4qlDt9vkQQTKPjqeJrvjMoHFAPfbL7WyHifRs3B
 G4zESfkasiLRwyepybQg==
Precedence: bulk
List-ID: <linux-leds.vger.kernel.org>
X-Mailing-List: linux-leds@vger.kernel.org

This is a multipart message in MIME format.

--=-=h6ZpeGmqlP0H2h=-=
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable

> -----Original Message-----
> From: Marek Behun [mailto:marek.behun@nic.cz]
> Sent: Samstag, 19. September 2020 22:32
> To: Adrian Schmutzler <freifunk@adrianschmutzler.de>
> Cc: linux-leds@vger.kernel.org
> Subject: Re: [PATCH v2 1/2] dt-bindings: leds: add LED_FUNCTION for
> wlan2g/wlan5g
>=20
> On Sat, 19 Sep 2020 21:24:26 +0200
> Adrian Schmutzler <freifunk@adrianschmutzler.de> wrote:
>=20
> > Many consumer "routers" have dedicated LEDs for specific WiFi bands,
> > e.g. one for 2.4 GHz and one for 5 GHz. These LEDs specifically
> > indicate the state of the relevant band, so the latter should be
> > included in the function name. LED_FUNCTION_WLAN will remain for
> > general cases or when the LED is used for more than one band.
> >
> > This essentially is equivalent to how we use LED_FUNCTION_LAN and
> > LED_FUNCTION_WAN instead of just having LED_FUNCTION_ETHERNET.
>=20
> Dont. If you want the LED name to inform the user about the WiFi device i=
t is
> being triggered on, it instead should come from the devicename part:
>   "wlan0:blue:activity"
>=20
> In fact the function should not be "wlan" (nor "wlan2g" or "wlan5g", but
> "activity".
>=20
> I am going to try to work on this subsystem so that if trigger source of =
the LED
> is set to a WiFi device and function is set to activity, the LED shall bl=
ink on wifi
> activity.
>=20
> This way we can also avoid using the `linux,default-trigger` property in =
favour
> of `function`, i.e. if I have:
>=20
>    wlan0: wifi@12300 {
>      compatible =3D "some-wifi";
>      #trigger-source-cells =3D <0>;
>    }
>=20
>    led {
>      color =3D <LED_COLOR_ID_BLUE>;
>      function =3D LED_FUNCTION_ACTIVITY;
>      trigger-sources =3D <&wlan0>;
>    };
>=20
> Than this will automatically name the LED as
>   wlan0:blue:activity
> and if the corresponding trigger is available, it should set the trigger =
even if
> no `linux,default-trigger` property is present.

Thanks for the explanation, I understand why this makes sense conceptually.

However, I assume your use of the word "will" indicates that I won't be abl=
e to build a solution like this with kernel 5.4?
So, easiest surrogate there would be to just stick to label property for th=
e moment ...?

How is the "device" part determined? Can I just change the DT label from wl=
an0 to wlan2g to get a more descriptive name, which will be translated into=
 the led name like wlan2g:blue:activity?

And finally, though partly off-topic:
Is there any way to determine the full "led name" from device-tree? We curr=
ently have aliases for certain leds, like
	led-upgrade =3D &led_somename;

The allowed us to construct the /sys/class/leds/<label> path directly from =
/proc/device-tree (in a user-space script), as we could access the label pr=
operty of the LED.
As far as I understand it, the color/function system does not provide a com=
parable lever, as the final name is only constructed in led-core.c?

Best

Adrian

--=-=h6ZpeGmqlP0H2h=-=
Content-Type: application/pgp-signature;
	name="openpgp-digital-signature.asc"
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEESgN6p2H3WoMOAf81oNyKO7qxAnAFAl9met0ACgkQoNyKO7qx
AnDX2A/+PsSZMsbaY8Y1vCSYDaoHZ89/GZXVlGjSm5oFeD4xiaZCwuMIAC5mjp3k
sRPlHidf7ihJLMlX3eVCwrScZGYU1kfkK9FVHQoSrc08B4XPT9IZC/tDwer2+05+
d8ynA/tMHBCe33fQFsmNX18eWl1rYKCut8r3ayEeCk/AqUT6IeK++5fJhk1NAWiD
YEgIimQbgAIs1KNIGFnuS2nmzXFyP115Gki6Tr51GVkk3h0kq4+6IPSpLx15a1+D
hg32apHeofbjYXa1cPzPqvkvFUNDqBGvpZj+OzPM2FZTegoLhPALfpYb1UqUzRp0
n6w88otdxzdZtxLk2e93fmmDzpzjtnJ5hboWGg9h3r1m1D3RpnOC7Ug3HTQgi7D2
8zJa4/zoj2VxRllCFtiu4rhqcWDc3XUgKE4kfrOPWrmH69EgE6/CSgUojwrC4dGI
nIN/V8TVFwYczf68wza09u4v1fG5rTLfHjLeQfLro1xO38QrmQunOuY++EO3sdu4
PNY8X6jSnVBuDZgP50u/HaPtK+NfDl6kryz0vBBWQ2Xr+NRWEjUtU3eqn0WmA9Yb
QHy0CTlGcWKXBU3o1sauddymxycFQ3e5JDlEuHuLTa8sVPk6sBgF9JEu1aBEysyn
kNUjA0CoFjIcBb2dFq5DUmFQnpX7qgHoq0Jo/1zhqvPSsJhfC5A=
=WKFn
-----END PGP SIGNATURE-----


--=-=h6ZpeGmqlP0H2h=-=--

